rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {
    match /batches/{batchId} {
      // 誰でも読める
      allow read;
      // 書き込みは認証不要（バックエンドからのみ想定）
      allow write;

      match /comments/{commentId} {
        // 誰でも読める
        allow read;
        // 書き込みは認証不要（バックエンドからのみ想定）
        allow write;
      }
    }

    // コレクショングループクエリ用のルール
    match /{path=**}/comments/{commentId} {
      // 誰でも読める
      allow read;
      // 書き込みは認証不要（バックエンドからのみ想定）
      allow write;
    }

    // 旧commentsコレクションも残しておく（互換性のため）
    match /comments/{commentId} {
      // 誰でも読める
      allow read;
      // 書き込みは認証不要（バックエンドからのみ想定）
      allow write;
    }
  }
}
